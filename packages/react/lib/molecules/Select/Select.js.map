{"version":3,"file":"Select.js","sources":["../../../src/molecules/Select/Select.tsx"],"sourcesContent":["import React, {\r\n    useState,\r\n    useRef,\r\n    useEffect,\r\n    KeyboardEventHandler,\r\n    createRef,\r\n} from \"react\";\r\nimport Text from \"@/atoms/Text\";\r\n\r\n\r\ninterface SelectOption {\r\n    label: string;\r\n    value: string;\r\n}\r\n\r\ninterface RenderOptionProps {\r\n    isSelected: boolean;\r\n    option: SelectOption;\r\n    getOptionRecommendedProps: (overrideProps?: Object) => Object;\r\n}\r\n\r\ninterface SelectProps {\r\n    onOptionSelected?: (option: SelectOption, optionIndex: number) => void;\r\n    options?: SelectOption[];\r\n    label?: string;\r\n    renderOption?: (props: RenderOptionProps) => React.ReactNode;\r\n}\r\n\r\nconst getPreviousOptionIndex = (currentIndex:number|null, options: Array<SelectOption>)=>{\r\n    if(currentIndex === null){\r\n        return 0;\r\n    }\r\n    if(currentIndex === 0){\r\n        return options.length - 1;\r\n    }\r\n    return currentIndex - 1;\r\n}\r\n\r\nconst getNextOptionIndex = (currentIndex:number|null, options: Array<SelectOption>)=>{\r\n    if(currentIndex === null){\r\n        return 0;\r\n    }\r\n    if(currentIndex === options.length - 1){\r\n        return 0;\r\n    }\r\n    return currentIndex + 1;\r\n}\r\n\r\nconst Select: React.FC<SelectProps> = ({\r\n    options = [],\r\n    label = \"Please select\",\r\n    onOptionSelected: handler,\r\n    renderOption,\r\n}) => {\r\n    const [isOpen, setIsOpen] = useState<boolean>(false);\r\n    const [selectedIndex, setSelectedIndex] = useState<null | number>(null);\r\n    const [highlightedIndex, setHighlightedIndex] = useState<null | number>(\r\n        null\r\n    );\r\n    const [overlayTop, setOverlayTop] = useState<number>(0);\r\n    const [optionRefs, setOptionRefs] = useState<\r\n        React.RefObject<HTMLLIElement>[]\r\n    >([]);\r\n    const labelRef = useRef<HTMLButtonElement>(null);\r\n\r\n    useEffect(() => {\r\n        setOverlayTop((labelRef.current?.offsetHeight || 0) + 10);\r\n    }, [labelRef.current?.offsetHeight]);\r\n\r\n    const onOptionSelected = (option: SelectOption, optionIndex: number) => {\r\n        if (handler) handler(option, optionIndex);\r\n        setSelectedIndex(optionIndex);\r\n        setIsOpen(false);\r\n    };\r\n\r\n    const onLabelClick = () => {\r\n        setIsOpen(!isOpen);\r\n    };\r\n\r\n    const highlightOption = (optionIndex: number | null) => {\r\n        setHighlightedIndex(optionIndex);\r\n\r\n    };\r\n\r\n    const onButtonKeyDown: KeyboardEventHandler = (event) => {\r\n        event.preventDefault();\r\n        if (\r\n            ['Enter','','ArrowDown'].includes(\r\n                event.key\r\n            )\r\n        ) {\r\n            setIsOpen(true); \r\n            highlightOption(0)\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        setOptionRefs(options.map((_) => createRef<HTMLLIElement>()));\r\n    }, [options.length]);\r\n\r\n    useEffect(()=>{\r\n        if(highlightedIndex !== null && isOpen){\r\n            const ref = optionRefs[highlightedIndex]\r\n            if(ref && ref.current){\r\n                ref.current.focus();\r\n            }\r\n        }\r\n    },[isOpen, highlightedIndex])\r\n\r\n    // console.log(1, optionRefs);\r\n\r\n   \r\n\r\n    const onOptionKeyDown: KeyboardEventHandler = (event) =>{\r\n        console.log(event.key)\r\n        if(event.key === 'Escape'){\r\n            setIsOpen(false)\r\n            return;\r\n        }\r\n        if(event.key === 'ArrowDown'){\r\n            highlightOption(getNextOptionIndex(highlightedIndex, options));\r\n        }\r\n        if(event.key === 'ArrowUp'){\r\n            highlightOption(getPreviousOptionIndex(highlightedIndex, options));\r\n        }\r\n        if(event.key === 'Enter'){\r\n            onOptionSelected(options[highlightedIndex!], highlightedIndex!)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className='dse-select'>\r\n            <button\r\n                data-testid='DseSelectButton'\r\n                role='menu'\r\n                aria-controls='dse-select-list'\r\n                aria-haspopup={true}\r\n                aria-expanded={isOpen ? true : undefined}\r\n                ref={labelRef}\r\n                className='dse-select__label'\r\n                onKeyDown={onButtonKeyDown}\r\n                onClick={() => {\r\n                    onLabelClick();\r\n                }}\r\n            >\r\n                <Text>\r\n                    {selectedIndex === null\r\n                        ? label\r\n                        : options[selectedIndex].label}\r\n                </Text>\r\n\r\n                <svg\r\n                    width='1rem'\r\n                    height='1rem'\r\n                    xmlns='http://www.w3.org/2000/svg'\r\n                    fill='none'\r\n                    viewBox='0 0 24 24'\r\n                    strokeWidth={1.5}\r\n                    stroke='currentColor'\r\n                    className={`dse-select__caret ${\r\n                        isOpen\r\n                            ? \"dse-select__caret--open\"\r\n                            : \"dse-select__caret--closed\"\r\n                    }`}\r\n                >\r\n                    <path\r\n                        strokeLinecap='round'\r\n                        strokeLinejoin='round'\r\n                        d='m4.5 15.75 7.5-7.5 7.5 7.5'\r\n                    />\r\n                </svg>\r\n            </button>\r\n            {isOpen && (\r\n                <ul\r\n                    id='dse-select-list'\r\n                    style={{ top: overlayTop }}\r\n                    className='dse-select__overlay'\r\n                >\r\n                    {options.map((option, optionIndex) => {\r\n                        const isSelected = optionIndex === selectedIndex;\r\n                        const isHighlighted = optionIndex === highlightedIndex;\r\n\r\n                        const ref = optionRefs[optionIndex];\r\n\r\n                        const renderOptionProps = {\r\n                            isSelected,\r\n                            option,\r\n                            getOptionRecommendedProps: (overrideProps = {}) => {\r\n                                return {\r\n                                    ref,\r\n                                    'aria-checked': isSelected ? true : undefined,\r\n                                    'aria-label': option.label,\r\n                                    tabIndex: isHighlighted ? -1: 0,\r\n                                    role: \"menuitemradio\",\r\n                                    className: `dse-select__option \r\n                                        ${isSelected ? \"dse-select__option--selected\" : \"\"} \r\n                                        ${isHighlighted ? \"dse-select__option--highlighted\" : \"\"}\r\n                                    `,\r\n                                    key: option.value,\r\n                                    onMouseEnter: () =>\r\n                                        highlightOption(optionIndex),\r\n                                    onMouseLeave: () => highlightOption(null),\r\n                                    onKeyDown: onOptionKeyDown,\r\n                                    onClick: () =>\r\n                                        onOptionSelected(option, optionIndex),\r\n                                    ...overrideProps,\r\n                                };\r\n                            },\r\n                        };\r\n                        if (renderOption) {\r\n                            return renderOption(renderOptionProps);\r\n                        }\r\n                        return (\r\n                            <li\r\n                                {...renderOptionProps.getOptionRecommendedProps()}\r\n                            >\r\n                                <Text>{option.label}</Text>\r\n                                {isSelected && (\r\n                                    <svg\r\n                                        width='1rem'\r\n                                        height='1rem'\r\n                                        xmlns='http://www.w3.org/2000/svg'\r\n                                        fill='none'\r\n                                        viewBox='0 0 24 24'\r\n                                        strokeWidth={1.5}\r\n                                        stroke='currentColor'\r\n                                        className='w-6 h-6'\r\n                                    >\r\n                                        <path\r\n                                            strokeLinecap='round'\r\n                                            strokeLinejoin='round'\r\n                                            d='m4.5 12.75 6 6 9-13.5'\r\n                                        />\r\n                                    </svg>\r\n                                )}\r\n                            </li>\r\n                        );\r\n                    })}\r\n                </ul>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Select;\r\n"],"names":[],"mappings":"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"}